#!/usr/bin/env node

const http = require('http')
const { createApp } = require('../app')


const Apps = [
  {
    name: 'CatWalkers',
    color: 'salmon',
    port: 4000,
    url: 'https://cat-walkers.zcap.test',
    databaseUrl: 'postgresql://localhost/zcap-demo-cat-walkers',
  },
  {
    name: 'BadBirders',
    color: 'aqua',
    port: 4001,
    url: 'https://bad-birders.zcap.test',
    databaseUrl: 'postgresql://localhost/zcap-demo-bad-birders',
  },
  {
    name: 'DopeDogs',
    color: 'khaki',
    port: 4002,
    url: 'https://dope-dogs.zcap.test',
    databaseUrl: 'postgresql://localhost/zcap-demo-drope-dogs',
  }
]


// TODO define a profile of apps with differnt:
// - domains
// - relationships to eachother
// - database urls
// hard code the keys here in a config objet

const apps = []
for (const options of Apps) {
  const otherApps = Apps.filter(o => o !== options)
  const app = createApp({ ...options, otherApps })
  apps.push(app)
  app.start(error => {
    if (error) console.error(error)
    else console.log(`${app.name} ${app.url}`)
  })
}
